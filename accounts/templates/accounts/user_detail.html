{% extends 'base.html' %}

{% load static %}

{% block title %} {{ user.username }} | Profile {% endblock %}

{% block content %}

<div class="container my-5">
    <div class="row g-4">
        <div class="col-lg-4">
            <div class="card shadow-sm border-0 text-center p-4">
                {% if user.image and user.image.path %}
                    <img src="{{ user.image.url }}"
                        class="rounded-circle mx-auto mb-3"
                        style="width:150px;height:150px;object-fit:cover;"
                        alt="{{ user.username }}">
                {% else %}
                    <img src="{% static 'accounts/images/default_profile_image.jpeg' %}"
                        class="rounded-circle mx-auto mb-3"
                        style="width:150px;height:150px;object-fit:cover;"
                        alt="default profile">
                {% endif %}

                <h4 class="fw-bold mb-0">@{{ user.username }}</h4>
                
                <div class="text-muted">
                    {{ user.get_full_name }} <br>
                    {{ user.email }}
                </div>

                {% if request.user == user %}
                <div class="d-grid {% if not user.bio %}mt-3{% endif %}">
                    <a href="{{ user.get_update_url }}" class="btn btn-outline-primary mb-2 mr-2">Edit Profile</a>
                    <a href="{% url 'accounts:user-logout' %}" class="btn btn-outline-secondary mb-2">Logout</a>
                </div>
                {% endif %}
            </div>
        </div>

        <div class="col-lg-8">
            <div class="mb-4 mt-1 text-center">
                {% if request.user != user %}
                    {% if not is_followed %}
                    <a href="{{ user.get_follow_url }}" class="btn btn-primary mr-2 mb-2">Follow</a>
                    {% else %}
                    <a href="{{ user.get_unfollow_url }}" class="btn btn-danger mr-2 mb-2">Unfollow</a>
                    {% endif %}
                {% endif %}
                <a href="{{ user.get_follower_list_url }}" class="btn btn-outline-info mr-2 mb-2">Followers {{ user.get_followers_count }}</a>
                <a href="{{ user.get_following_list_url }}" class="btn btn-outline-info mr-2 mb-2">Following {{ user.get_following_count }}</a>
            </div>

            {% if request.user == user %}
            <div class="card border-danger">
                <div class="card-header bg-danger text-white">Danger Zone</div>
                <div class="card-body">
                    <a href="{{ user.get_delete_url }}" class="btn btn-danger mr-2 mb-2">Delete Account</a>
                    {% if user.image %}
                    <a href="{{ user.get_profile_image_delete_url }}" class="btn btn-outline-danger mr-2 mb-2">Delete Profile Image</a>
                    {% endif %}
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}